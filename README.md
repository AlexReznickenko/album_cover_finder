# Техническое задание по проекту: Необходимо разработать модель, которая определит жанр музыкального альбома по изображению его обложки.

<b>Цель: </b> Необходимо разработать модель, которая определит жанр музыкального альбома по изображению его обложки.

<b>Используемые для решения задачи данные:</b>

Данные представляют собой набор изображений, рассортированных по папкам. Название папки соответствует музыкальному жанру. Представлены следующие жанры: anime, black metal, classical, country, disco, edm, jazz, pop, rap, reggae

<b>Задачи:</b>
-  Создать ML-продукт, который предсказывает, к какому жанру относится изображение
-  Протестировать модель
-  Создать эмбеддинги
-  
  ### Pipeline решения
- Составить csv-таблицу со списком файлов и целевой переменной
- Анализ данныз (выявление проблем)
- Преобразование данных в эмбеддинги и подготовка данных
- Решение с помощью поиска ближайших соседей
- Решение с помощью использования стандартных моделей
- Решение с помощью fastai

  
## Итоговый результат

Мы проанализировали данные на проблемы и не обнаружили их. В качестве метрики был выбран accuracy и f1. Мы использовали несколько методов для определения стиля альбома по обложке. Кроме того, мы использовали аугментацию - то есть, создание дублирующих изображений с изменёнными параметрами яркости и отражённых.

Для обучения моделей и поиска ближайших соседей были использованы эмбеддинги, созданные при помощи предобученной модели resnet50.
Поиск по ближайшим соседям с помощью faiss показал слабый результат, однако аугментация улучшила его. Возможно, дополнительная аугментация смогла бы ещё больше улучшить результат.
Среди моделей лучше всего показала себя логистическая регрессия. На всех жанрах она показала результат F1 Score: 0.583, accuracy: 0.583 без аугментации. CatBoost показал результат хуже.

Была дообучена модель resnet50 с помощью модуля fastai. Она показала лучший результат - 70% accuracy, однако её недостаток в том, что её обучение требует больших вычислительных мощностей.

Также заметим, что все методы (кроме fastai, в этом плане она не проверялась) показали гораздо лучшие результаты при меньшем количестве жанров.

## Стек
pandas,  numpy, catboost, logisticregression, torchvision, resnet50, fastai, faiss

## Состав проекта:
| **Название файла**  | **Содержание**                            |
|:--------------------|:------------------------------------------|
|(https://github.com/AlexReznickenko/album_cover_finder/blob/main/album_final.ipynb)       | основной ноутбук с проектом |
[data] отсутствует в репозитории         | данные для проекта |
